SPOJ CPATTERN

【题目大意】

给出N(1 <= N <= 100000)头排成一列的奶牛的身高（范围1..S）和长度为K的捣乱身高趋势，求出这个队伍里有多少个子列满足捣乱身高趋势。

趋势相同指：对于每头奶牛，其身高排名都相等。

【算法分析】

由于是个匹配问题，我们考虑KMP。若在两个序列a, b里对应位置的x, y排位相同，即a中小于x的个数和小于等于x的个数与b中小于y的个数和小于等于y的个数相等。

因此，我们只要将KMP的比较函数从相等修改为趋势相同（描述如上），保证每一位的排位均相等，则匹配成功。为了动态维护这个排位，我们用树状数组来维护小于、小于等于某个数的个数。时间复杂度O((N + K)logS)。
