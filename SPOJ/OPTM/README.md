SPOJ OPTM

【题目大意】

给出一个N个点(1 <= N <= 500)M条边(0 <= M <= 3000)的无向图，已知部分点的权值，求剩余点的一种标号方案，使得每条边的权值为该边两点权值的异或值时，所有边权和最小。若边权和相同，则要求点权和也最小。

【算法分析】

异或往往有一些特殊的性质，比如这道题里，我们对每一位分别处理，是不会影响答案的。

考虑某一位，我们要把所有点分割成0和1两个集合，使得集合之间的边最少。只要将原图中的无向边变为新图中正反向容量为1的边，那么显然可以用最小割来解决。

考虑题中给出的已定权值，其实是把这些点已经放入了0/1集合中，那么，只要将这些点与源/汇点连容量正无穷的边（不可能割开），就可以保证他们在规定的集合里。

考虑最后一个要求，点权和最小，也就是说，对于每一位，我们要让0集合的点尽量多，即1集合的点尽量少。根据残余网络的性质，我们用求最大流的算法得到的残余网络里的S集合必定是最小的。因此，我们将1集合定为S集合，0集合定为T集合。

对于位k处理完后，把1集合里的点对应的答案异或1 << k即可。设K为最大位数，时间复杂度O(KMN^2)。
