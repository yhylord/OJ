113 - Codeforces Beta Round #86 (Div. 1 Only)

D. Museum

【题目大意】

有N(1 <= N <= 22)个房间，M个相通关系，两个人起点分别在A、B，每个人每分钟有P_i(0.01 <= P_i <= 0.99)的概率停在原地i，有1 - P_i的概率等概率地去任何一个i通向的房间，当两人同时到达同一房间时终止，求在每个房间终止的概率。

【算法分析】

将第一个人在i，第二个在j的状态记为(i, j)，用P(i, j, t)表示t时刻到(i, j)的概率，那么显然可以得到P(i, j, t)关于P(x, y, t - 1)的递推式，然后，我们可以考虑用矩阵乘法迭代2^K次，总体时间复杂度为O(KN^6)，在保证收敛到精度要求内时不一定能在时限内出解。

考虑直接求出精确答案，即不能记录无穷的时间t。于是，我们令S(i, j) = sigma{P(i, j, t)}，同样，我们可以得到S(i, j)关于S(x, y)的递推式，注意P(A, B, 0) = 1。由于每个时刻t都可以推出下一个时刻t + 1，所以我们这样做是正确的。但由于这个递推式是带环的，不可以直接求解，考虑高斯消元法，时间复杂度O(N^6)。

那么，S(i, i)就是我们输出的答案，因为它是终止态，其概率必然由一开始的1分散而来，故输出的答案相加和为1，符合题意。
