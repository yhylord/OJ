272 - Codeforces Round #167 (Div. 2)

C. Dima and Staircase

【题目大意】

从左往右依次堆放着N(1 <= N <= 10^5)个高度为a_i的石块（高度不降），现在给M(1 <= M <= 10^5)个宽w_i高h_i的箱子依次紧靠着最左端扔下，遇障碍停止，问每个箱子的底部所处的高度。

【算法分析】

不仔细看题的话，可以使用线段树来实现操作，时间复杂度O((N + M)logN)。

仔细看题会发现，整个堆积的样子是不降的，所以每次只要判断右端点的高度即可，时间复杂度O(N + M)。

D. Dima and Two Sequences

【题目大意】

给出两个长度为N(1 <= N <= 10^5)的点序列(a_1, 1), (a_2, 2), ..., (a_N, N)和(b_1, 1), (b_2, 2), ..., (b_N, N)，求所有用这些点排列而成的x坐标不降的不同序列个数。

【算法分析】

由于要求x坐标不降，我们可以以x坐标为第一关键字、y坐标为第二关键字从小到大排序，那么，每个x坐标所在的区域就是固定的，只要对每个x坐标求解相乘即可。

假设某一个x坐标有K个点，排列即为K!，但我们发现其中有重复，而且恰好不超过两次。因此，我们只要统计出重复两次的点的个数T，答案即为K! / 2^T，为方便计算对1至K的前T个偶数除以2即可。整体时间复杂度O(NlogN)。

E. Dima and Horses

【题目大意】

有N(1 <= N <= 3 * 10^5)只马，M(0 <= M <= min(3 * 10^5, n * (n - 1) / 2))个敌对关系，每只马最多有三个敌人，现在要把马分成两队，要求每只马不能有超过一个敌人和它在同一队中，求一种可行方案。

【算法分析】

考虑构造答案，假设一开始都在同一队中，此时有可能是不合法的，于是我们要进行调整。首先将1 ~ N放入队列里，假如与当前马在同队的敌人不超过1个，则不管它；否则将自己所在的队伍取反，然后检查自己的3个敌人，把敌人中存在矛盾的放入队列里，这样不断重复下去，直到队空。

下面我们来讨论它的复杂度，首先，矛盾关系必然不会超过M对，那么，我们每做一次取反操作，若原本有2个敌人在同队，就会先减少2个敌对关系，剩下最多1个敌人可能导致矛盾从而增加最多1个敌对关系，总体减少至少1个敌对关系；若原本有3个敌人在同队，则可以减少3个敌对关系。

由此，取反操作不超过M个。然后考虑队列的元素总数，除一开始加入队列的N个元素和M个需要取反操作的元素外，每个取反操作最多产生3个新元素，所以元素总数是N + M的常数倍，整体时间复杂度为O(N + M)。
