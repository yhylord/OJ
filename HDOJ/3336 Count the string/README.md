HDOJ 3336 Count the string

【题目大意】

给出一个长度为N(1 <= N <= 200000)的字符串，求这个字符串的每个前缀在整个字符串里出现次数的和。

【算法分析】

考虑枚举i，则要求以i为结尾的子串有多少个是前缀，也就是s[1..i]有多少个后缀是这个字符串的前缀。

我们知道，通过KMP算法求出的p[i]表示s[1..i]和这个字符串前缀的最长匹配长度，它应当被计入答案，同理，p[p[i]], p[p[p[i]]], ...对应的前缀也都应计入答案。

为加速计算，我们很容易得到递推式f[i] = f[p[i]] + 1。时间复杂度O(N)。
