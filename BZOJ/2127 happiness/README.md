BZOJ 2127 happiness

分集合的问题，很容易想到最小割。又因为要收益最大，通常是把所有的收益相加减去为构成合法方案而砍掉的最少收益。

首先考虑分文理科，这个很简单，只要源点向每个点连容量为选文科的收益的边，每个点向汇点连容量为选理科的收益的边，那么选理科的被分到S集合，选文科的被分到T集合。

接下来就只有相邻点之间的边了。

我们分析相邻的同学A和B（设A在S集合中，即选理科）：

若B也在S集合中（即选理科），则我们需要扣除的是两者同选文科的收益；

若B在T集合中（即选文科），则我们既要扣除两者同选文科的收益，也要扣除两者同选理科的收益。

由于A和B同在S集合时，他们之间的边不会被割掉，也就是说，扣除的收益必须在一开始选科的边里体现。

那么，我们自然得到，从源点再向A和B分别连容量为同选文科的收益的一半的边，从A和B分别再向汇点连容量为同选理科的收益的一半的边即可。

再看B在T集合的情况，由于文理各扣了一半，而此时他们之间的边需要被割，那么剩下来的一半就在相邻点之间连边的容量上体现了。

为了方便处理“一半”，我们在一开始把所有收益乘2，最后答案再除以2即可。

时间复杂度O((NM)^3)。
