BZOJ 3246 Dreaming

首先显然的一点是，一棵树必然用离最远的点最近的那个点来和其他树相接，而这个点又必然在这棵树的直径上。

我们将离最远点的最近距离从大到小排序后，记排名i的为d_i，则答案至少为max{d_1 + d_2 + L, d_2 + d_3 + 2L}。

因为假如d_2与d_3直接相连，则d_1必与d_2、d_3中的一个不直接相连，而d_1 + d_2/3 + 2L >= d_2 + d_3 + 2L。

同时，我们可以构造出d_1与其他所有树直接相连，这样d_1 + d_k + L <= d_1 + d_2 + L，d_i + d_j + 2L <= d_2 + d_3 + 2L(i, j >= 2)。

由此，答案就可以确定为max{max{树的直径}, d_1 + d_2 + L, d_2 + d_3 + 2L}。当然要注意的是，第二项只有N - M >= 2时才要考虑，第三项只有N - M >= 3时才要考虑。

时间复杂度O(N)。
