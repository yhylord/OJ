BZOJ 2879 美食节

可以看出这道题的模型和上一题是一模一样的，但数据范围大了很多。

依照上一题的建图方式，我们把每个厨师拆成P个点，代表倒数第几个做菜产生的贡献值（倒数第几个 * 做菜时间）。

那么，我们只需要将源点向菜连容量为需求量费用0的边，将各个拆出的厨师点向汇点连容量1费用0的边，将菜向每个厨师的每个做菜位次连容量1费用相应贡献值的边，那么求出最小费用最大流一定对应着最优且合法的分配方案。

由于数据范围扩大，这样做是明显不行的，考虑进行优化。

首先我们要注意到的是，每次增广的流量都是1，且共增广P次。那么，在拆出去的那些点中，也就只有P个被增广到，其实也只有这P个是有用的。

我们发现，由于每次增广费用最小，对于一个厨师，一定是先增广到倒数第一个做菜的点，才会增广到倒数第二个，以此类推。

因而，对于厨师，我们只需要一开始建M个点（倒数第一个做菜的点），每次增广完毕后，对于被增广的那个厨师，我们再新建倒数第二个做菜的点，并连相关的边，以此类推。

这样的话，我们就保证了总点数V = N + M + P，总边数E = (P + M) * N，总时间复杂度O(PVE)。
