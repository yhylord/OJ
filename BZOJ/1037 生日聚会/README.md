BZOJ 1037 生日聚会

对于要求的任意连续一段差不超过K，其实只需要满足以每个人为终点的差最大的一段的差不超过K就可以了。

记f(i, j, p, q)表示男孩i个，女孩j个，在前i + j个人里在每个人为终点时的男孩数 - 女孩数最小为-p个，最大为q个时的方案数。

对于当前状态只需要枚举下一个人是男孩还是女孩并且转移合法即可完成转移。

转移到下一个状态f(i', j', p', q')合法的条件是max{|i' - j' + p|, |i' - j' - q|} <= K。

时间复杂度O(NMK^2)。
