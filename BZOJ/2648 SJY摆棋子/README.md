BZOJ 2648 SJY摆棋子

由于有大量的插入操作，我们需要使用K-D Tree的离线插入。

离线插入需要利用标记来实现，如果在建树之后对每个询问插入，无法知道往左边走还是往右边走，复杂度就无法保证。

为此，我们记录每个点的father，然后记每个询问加的点在树里的指针，这样只要改一下它的mark，把它到根的路径update一遍就好了。

矩形优化是必须加的，因为不能把未插入的点作为判断反向搜索的标准。

随机数据期望时间复杂度O((N + M)log(N + M))。
