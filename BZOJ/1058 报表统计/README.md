BZOJ 1058 报表统计

先不管插入这个操作，考虑查询相邻差值的最小值。

用平衡树维护这个序列，记录以该结点为根的子树表示的区间的最左数、最右数、最小差，最左数和最右数是很好维护的。

而最小差，就用左儿子、右儿子内部的最小差，以及左儿子的最右数和右儿子的最左数分别和当前结点作差比较就行了。

那么，全局最接近数的差，就把这个序列变成有序序列进行维护。

所以，我们维护这样两棵平衡树就可以了。

现在考虑插入，全局有序的平衡树是直接插的。

而原序列的平衡树，我要知道插入的位置，于是另外维护一个树状数组，每插一个数对应位置加1，那么求和就可以得到当前插入数的位置了。

当然还要加一些常数优化，由于数的个数非常多，要用指针代替数组寻址。

其次，我们发现全局最接近数的差是单调减的，所以当已经减到0的时候就不用再对这棵平衡树操作了。

时间复杂度O((N + M)log(N + M))。
