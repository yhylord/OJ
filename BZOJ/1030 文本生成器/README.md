BZOJ 1030 文本生成器

我们首先将单词建立AC自动机，并计算转移函数。

令f[0/1][i][j]表示是否包含过单词，到文本第i位，AC自动机上第j个结点时的方案数，递推是显然的。

时间复杂度O(ML)。
