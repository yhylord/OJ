BZOJ 2131 免费的馅饼

首先，暴力DP的思路是比较明显的，假如我们按时间从小到大排序，有f(i) = max{f(j) + 1}, j < i && |p_i - p_j| <= 2(t_i - t_j)。

时间复杂度O(N^2)，我们肯定要从转移上想办法优化。

令x = t_i, x' = t_j, y = p_i, y' = p_j，则j可以转移到i的条件是|y - y'| <= 2(x - x')也就是y - y' <= 2(x - x')即2x' - y' <= 2x - y且y' - y <= 2(x - x')即2x' + y' <= 2x + y。

那么我们变换坐标(x, y)为(2x - y, 2x + y)以后，每个点可以从它左下方的点转移过来。

那么我们按新坐标里的第一关键字x从小到大第二关键字y从小到大排序以后，对于j < i，一定有x' <= x，于是我们要找的就是y' <= y的最大的f(j)。

这个用树状数组就可以维护了，其中y要离散化。

时间复杂度O(NlogN)。
