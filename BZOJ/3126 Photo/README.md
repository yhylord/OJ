BZOJ 3126 Photo

令f[i]表示1 ~ i最后一个放i最多能放几个，那么f[i] = max{f[j]} + 1，其中j必须保证i和j之间没有区间，同时i和j不包含在同一个区间中。

因此，我们需要求出每个i需要的j的范围，这是可以排序以后扫描得到的。

那么，我们用线段树求出一个区间的最大值即可完成转移。

时间复杂度O(NlogN)。
