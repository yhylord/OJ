BZOJ 1009 GT考试

对于不吉利数段，我们可以利用p数组预处理出在第i位后接j之后的最长匹配位置nxt[i][j]。

为了记录当前匹配的状态，我们用f[i][j]表示到准考证号第i位，匹配到不吉利数段第j位的方案数，那么枚举在后一位添加的数字k，显然可以转移到f[i + 1][nxt[j][k]]（若nxt[j][k]为M则不能转移）。

由于N很大，我们可以使用矩阵乘法 + 快速幂来加速计算。时间复杂度O(M^3logN)。
