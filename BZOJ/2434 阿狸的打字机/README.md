BZOJ 2434 阿狸的打字机

首先把这些串全部存起来是不现实的，那么我们想到使用Trie树来存储，并建立成AC自动机。

我们把fail指针全部反向形成的一棵树称为fail树。

考虑询问(x, y)，实质就是在fail树上，找以x的末结点为根的子树上，有多少个结点在AC自动机中root -> y的末结点的路径上。

那么我们再次处理操作序列，就可以很方便地模拟出每一个root -> y末结点路径上的结点都标记为1的情形，下面我们需要处理对应的x的询问。

我们要做的是查询一棵子树的和，这是经典的DFS序 + 树状数组维护，在此不再赘述。那么，我们把所有与y对应的x答案都处理出来即可。

时间复杂度O(L + MlogL)。
