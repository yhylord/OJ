BZOJ 3123 森林

假如没有询问，那就是很经典的用可持久化线段树 + LCA解决路径第k大问题了。

考虑合并操作，我们采用启发式合并，每次将小的那棵子树暴力重建其倍增数组和可持久化线段树（接到大树上），易证每个结点最多被重建logN次。

由于每个结点的权值不变，因此对应的可持久化线段树形态也不变，重建时只需修改线段树维护的和即可。

时间复杂度O(Nlog^2N)。
