BZOJ 3204 城市规划

由于直接处理较复杂，我们考虑将这个地图按行分成sqrt(N)块。

首先，对于每一块，我们可以在sqrt(N)的时间内利用并查集处理出和边缘不相通的连通块个数，以及两个边缘的并查集。

同样，修改操作，我们可以重新构造那一块的答案。

对于询问，我们首先要把询问的区间不在整块里的两头的答案用上述的方法求出。

接下来就是若干个块的合并了，首先先把各块与边缘不相通的答案累加起来，之后再考虑相邻边缘的合并。

我们把并查集中原来所属的集合重标号，然后再次用相似的方法合并，最后再统计连通块个数即可。

当然，只有带O的连通块才需要统计。

时间复杂度O(NM + MQsqrt(N))。
