BZOJ 3131 淘金

首先我们考虑要求的答案，就是新的二维坐标系里的前K大数的和。

横纵坐标是互不影响的，假设我们已经求出了积为x的原始坐标个数g(x)，那么新的点(x, y)上的数就是g(x) * g(y)。

因此，我们将g数列排序，并复制一遍，就转化为了求两个有序数列两两相乘的前K大数，这是经典的多路归并问题，可以用堆解决。

接下来的问题就是计算g(x)。考虑到积是1~9乘出来的，其质因子只有2, 3, 5, 7，经计算在10^12内这样的数只有一万多个。

那么我们就可以用数位DP来求出N范围内的g(x)了，这个可以有多种实现方法，其中乘积的一维可以用map来存。

设积的总个数为S，则时间复杂度为O((K + S)logS)。
